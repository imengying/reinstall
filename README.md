# ä¸€é”®é‡è£…ç³»ç»Ÿ - Debian ç‰ˆ

æœ¬é¡¹ç›®æ˜¯ [@bin456789/reinstall](https://github.com/bin456789/reinstall) çš„ç²¾ç®€é‡æ„ç‰ˆæœ¬ï¼Œä¸“æ³¨äºï¼š**å°†ç°æœ‰ Linux ç³»ç»Ÿä¸€é”®é‡è£…ä¸ºçº¯å‡€çš„ Debian ç³»ç»Ÿï¼Œå¹¶å¼ºåˆ¶é‡‡ç”¨ Btrfs æ–‡ä»¶ç³»ç»Ÿ + Zstd é€æ˜å‹ç¼©**ï¼Œä»¥å®ç°æè‡´çš„ç£ç›˜ç©ºé—´èŠ‚çœå’Œ I/O æ€§èƒ½æå‡ã€‚

## âœ¨ æ ¸å¿ƒç‰¹æ€§

- **çº¯å‡€ Debian**ï¼šå‰”é™¤å†—ä½™ä»£ç ï¼Œä¸“æ³¨äº Debian ç³»ç»Ÿçš„å®Œç¾å®‰è£…ã€‚
- **Btrfs + Zstd**ï¼šé»˜è®¤ä½¿ç”¨ Btrfs æ–‡ä»¶ç³»ç»Ÿå¹¶å¼€å¯ Zstd é€æ˜å‹ç¼©ï¼Œ**èŠ‚çœ 30%-50% ç£ç›˜ç©ºé—´**ï¼Œå¤§å¹…æå‡ I/O æ€§èƒ½ã€‚
- **éšæœºå¯†ç **ï¼šé»˜è®¤ç”Ÿæˆé«˜å¼ºåº¦éšæœºå¯†ç ï¼Œä¿éšœç³»ç»Ÿå®‰å…¨ï¼ˆå®‰è£…ç»“æŸæ—¶æ˜¾ç¤ºï¼‰ã€‚
- **DD æ”¯æŒ**ï¼šæ”¯æŒ `dd` å‘½ä»¤åŸæ ·å†™å…¥ä»»æ„ç³»ç»Ÿé•œåƒï¼ˆraw imageï¼‰ã€‚
- **æ™ºèƒ½ç½‘ç»œ**ï¼š
    - è‡ªåŠ¨è¯†åˆ«å¹¶ä¿®å¤ Azure åŠ é€Ÿç½‘ç»œé—®é¢˜ã€‚
    - Alpine initrd ä½¿ç”¨ `udhcpc`ï¼Œè§£å†³éƒ¨åˆ†äº‘å‚å•†ï¼ˆå¦‚ç§»åŠ¨äº‘ï¼‰DHCP ç§Ÿçº¦é—®é¢˜ã€‚
    - æ”¯æŒ `--frpc-toml` ä½¿ç”¨ HTTP/HTTPS é“¾æ¥é…ç½®å†…ç½‘ç©¿é€ã€‚
- **å®‰å…¨åŠ å›º**ï¼šä½¿ç”¨ `/dev/urandom` ç”Ÿæˆéšæœºå¯†ç ï¼Œé˜²æ­¢é˜»å¡ã€‚

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å®‰è£… Debian (æ¨è)

æœ€ç®€å•çš„ä½¿ç”¨æ–¹å¼ï¼Œè‡ªåŠ¨å®‰è£…æœ€æ–°ç‰ˆ Debianï¼š

```bash
bash reinstall.sh debian
```

å®‰è£…ç‰¹å®šç‰ˆæœ¬ï¼ˆæ”¯æŒ 9, 10, 11, 12, 13ï¼‰ï¼š

```bash
bash reinstall.sh debian 12
```

### æŒ‡å®šå¯†ç 

å¦‚æœä¸ä¹ æƒ¯éšæœºå¯†ç ï¼Œå¯ä»¥æŒ‡å®šå›ºå®šå¯†ç ï¼š

```bash
bash reinstall.sh debian --password "YourPassword"
```

### DD å®‰è£…



```bash
bash reinstall.sh dd "https://example.com/disk.img"
```

> [!NOTE]
> **DD æ¨¡å¼è¯´æ˜**ï¼š
> DD æ¨¡å¼ä¼šå°†é•œåƒå†…å®¹**åŸæ ·å†™å…¥**ç£ç›˜ï¼Œä¸ä¼šä¿®æ”¹æ–‡ä»¶ç³»ç»Ÿã€åˆ†åŒºæˆ–æŒ‚è½½é€‰é¡¹ã€‚
> è‹¥éœ€ä½¿ç”¨ Btrfs + Zstd å‹ç¼©ç‰¹æ€§ï¼Œè¯·ä½¿ç”¨ä¸Šè¿°çš„æ™®é€š Debian å®‰è£…æ¨¡å¼ã€‚
>
> **æ‰‹åŠ¨å¼€å¯å‹ç¼©ï¼ˆä»…é™ Btrfs é•œåƒï¼‰**ï¼š
> å¦‚æœæ‚¨ DD çš„é•œåƒæ˜¯ Btrfs æ–‡ä»¶ç³»ç»Ÿï¼Œå¯åœ¨å®‰è£…åæ‰‹åŠ¨å¼€å¯å‹ç¼©ï¼š
> 1. ç¼–è¾‘ `/etc/fstab`ï¼Œåœ¨æŒ‚è½½é€‰é¡¹ä¸­æ·»åŠ  `compress=zstd`
> 2. é‡æ–°æŒ‚è½½æˆ–é‡å¯
> 3. å¯¹ç°æœ‰æ•°æ®è¿›è¡Œå‹ç¼©ï¼š`btrfs filesystem defragment -r -v -czstd /`

### æ›´å¤šé€‰é¡¹

```bash
# æŒ‡å®š SSH ç«¯å£
bash reinstall.sh debian --ssh-port 2222

# å¯¼å…¥ SSH å…¬é’¥
bash reinstall.sh debian --ssh-key "ssh-ed25519 AAAA..."
bash reinstall.sh debian --ssh-key "https://github.com/username.keys"

# é…ç½® FRPC å†…ç½‘ç©¿é€
bash reinstall.sh debian --frpc-toml "https://example.com/frpc.toml"
```

## ğŸ› ï¸ ç³»ç»Ÿé…ç½®è¯¦æƒ…

- **é»˜è®¤ç”¨æˆ·**ï¼š`root`
- **é»˜è®¤å¯†ç **ï¼šå®‰è£…ç»“æŸååœ¨ç»ˆç«¯æ˜¾ç¤ºï¼ˆéšæœºç”Ÿæˆï¼‰ï¼Œè¯·åŠ¡å¿…è®°å½•ï¼
- **æ–‡ä»¶ç³»ç»Ÿ**ï¼šBtrfs (Mount options: `compress=zstd,noatime`)
- **åˆ†åŒºå¸ƒå±€**ï¼šè‡ªåŠ¨æœ€å¤§åŒ–åˆ©ç”¨ç£ç›˜ï¼Œæ—  Swap åˆ†åŒºï¼ˆèŠ‚çœç©ºé—´ï¼‰ã€‚



## ğŸ“¦ ä¾èµ–è¯´æ˜

è„šæœ¬ä¼šåœ¨è¿è¡Œå‰è‡ªåŠ¨æ£€æŸ¥å¹¶å®‰è£…æ‰€éœ€ä¾èµ–ï¼ˆå¦‚ `curl`, `grep`, `openssl` ç­‰ï¼‰ã€‚

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®éµå¾ª [MIT License](LICENSE)ã€‚
